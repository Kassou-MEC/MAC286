<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Double Hashing Hash Tables – Interactive Presentation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#10ac84 0%,#1dd1a1 100%);min-height:100vh;color:#333;overflow-x:hidden}
    .presentation-container{max-width:1200px;margin:0 auto;padding:20px;display:flex;flex-direction:column}
    .scroll-indicator{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);background:rgba(16,172,132,.8);color:#fff;padding:5px 15px;border-radius:20px;font-size:12px;opacity:0;transition:opacity .3s;pointer-events:none}
    .scroll-indicator.show{opacity:1}
    .slide{background:#fff;border-radius:15px;padding:40px;margin-bottom:30px;box-shadow:0 10px 30px rgba(0,0,0,.2);opacity:0;transform:translateY(30px);transition:all .6s;min-height:calc(100vh - 100px);max-height:calc(100vh - 100px);overflow-y:auto;display:none;position:relative}
    .slide.active{opacity:1;transform:translateY(0);display:block}
    .slide::-webkit-scrollbar{width:8px}
    .slide::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}
    .slide::-webkit-scrollbar-thumb{background:#10ac84;border-radius:4px}
    h1{font-size:2.5em;color:#2c3e50;text-align:center;margin-bottom:30px;background:linear-gradient(45deg,#10ac84,#1dd1a1);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    h2{font-size:2em;color:#34495e;margin-bottom:20px;border-bottom:3px solid #10ac84;padding-bottom:10px}
    h3{font-size:1.5em;color:#10ac84;margin:20px 0 15px}
    .definition-box{background:linear-gradient(135deg,#54a0ff,#2e86de);color:#fff;padding:25px;border-radius:10px;margin:20px 0;border-left:5px solid #10ac84}
    .real-life-example{background:linear-gradient(135deg,#feca57,#ff9ff3);color:#2c3e50;padding:25px;border-radius:10px;margin:20px 0;position:relative;overflow:hidden}
    .real-life-example::before{content:'Library';position:absolute;top:10px;right:15px;font-size:2em;opacity:.3}
    .hash-table-visual{display:flex;justify-content:center;margin:30px 0;flex-wrap:wrap;gap:12px}
    .hash-slot{width:80px;height:60px;border:2px solid #10ac84;border-radius:8px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#fff3cd;transition:all .3s;position:relative;font-size:0.9em}
    .hash-slot.occupied{background:linear-gradient(135deg,#1dd1a1,#10ac84);color:#fff;font-weight:bold}
    .hash-slot.collision{background:linear-gradient(135deg,#ee5a52,#c0392b);color:#fff;animation:pulse 1s infinite}
    .hash-slot .index{font-size:.7em;color:#7f8c8d;position:absolute;top:2px;left:5px}
    .hash-slot.occupied .index{color:rgba(255,255,255,.7)}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    .code-container{background:#2c3e50;color:#ecf0f1;padding:25px;border-radius:10px;margin:20px 0;font-family:'Courier New',monospace;font-size:14px;line-height:1.6;overflow-x:auto;position:relative}
    .code-container::before{content:'Java Code';position:absolute;top:5px;right:15px;background:#10ac84;color:#fff;padding:2px 8px;border-radius:4px;font-size:.8em}
    .copy-btn{position:absolute;top:5px;right:100px;background:#27ae60;color:#fff;padding:5px 10px;border:none;border-radius:4px;font-size:12px;cursor:pointer}
    .copy-btn:hover{background:#1e8449}
    .keyword{color:#e74c3c;font-weight:bold}
    .string{color:#2ecc71}
    .comment{color:#95a5a6;font-style:italic}
    .method{color:#f39c12}
    .interactive-demo{background:#fff8e1;padding:25px;border-radius:10px;margin:20px 0;border:2px dashed #10ac84}
    .demo-controls{display:flex;gap:15px;margin-bottom:20px;flex-wrap:wrap}
    .demo-input{padding:10px;border:2px solid #bdc3c7;border-radius:5px;font-size:16px;outline:none;transition:border-color .3s}
    .demo-input:focus{border-color:#10ac84}
    .demo-button{background:linear-gradient(135deg,#1dd1a1,#10ac84);color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:16px;font-weight:bold;transition:transform .2s}
    .demo-button:hover{transform:translateY(-2px)}
    .demo-button:active{transform:translateY(0)}
    .step-log{background:#2c3e50;color:#ecf0f1;padding:15px;border-radius:8px;margin-top:15px;font-family:'Courier New',monospace;font-size:13px;max-height:200px;overflow-y:auto}
    .navigation{position:fixed;bottom:30px;right:30px;display:flex;gap:15px;z-index:1000}
    .nav-button{background:#10ac84;color:#fff;border:none;padding:15px 20px;border-radius:50px;cursor:pointer;font-size:18px;font-weight:bold;transition:all .3s;box-shadow:0 4px 15px rgba(16,172,132,.4);min-width:50px;min-height:50px;display:flex;align-items:center;justify-content:center}
    .nav-button:hover{background:#0e9b74;transform:translateY(-2px);box-shadow:0 6px 20px rgba(16,172,132,.6)}
    .nav-button:disabled{opacity:.5;cursor:not-allowed}
    .progress-bar{position:fixed;top:0;left:0;height:4px;background:linear-gradient(90deg,#10ac84,#1dd1a1);transition:width .3s;z-index:1000}
    .advantages-disadvantages{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin:20px 0}
    .advantage{background:linear-gradient(135deg,#55efc4,#00b894);color:#fff;padding:20px;border-radius:10px;position:relative}
    .advantage::before{content:'Check';position:absolute;top:10px;right:15px;font-size:1.5em;font-weight:bold}
    .disadvantage{background:linear-gradient(135deg,#fdcb6e,#e17055);color:#fff;padding:20px;border-radius:10px;position:relative}
    .disadvantage::before{content:'Cross';position:absolute;top:10px;right:15px;font-size:1.5em}
    .complexity-table{width:100%;border-collapse:collapse;margin:20px 0;background:#fff;border-radius:10px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,.1)}
    .complexity-table th,.complexity-table td{padding:15px;text-align:left;border-bottom:1px solid #f1f1f1}
    .complexity-table th{background:linear-gradient(135deg,#10ac84,#1dd1a1);color:#fff;font-weight:bold}
    .complexity-table tr:nth-child(even){background:#fff8e1}
    @media(max-width:768px){
        .presentation-container{padding:10px}
        .slide{padding:20px}
        h1{font-size:2em}
        h2{font-size:1.5em}
        .advantages-disadvantages{grid-template-columns:1fr}
        .demo-controls{flex-direction:column}
        .hash-table-visual{gap:10px}
        .hash-slot{width:70px;height:55px}
    }
    .highlight-animation{animation:highlight 2s ease-in-out}
    @keyframes highlight{0%,100%{background-color:transparent}50%{background-color:rgba(16,172,132,.3)}}
</style>
</head>
<body>
<div class="progress-bar" id="progressBar"></div>

<div class="presentation-container">

<!------------------- SLIDE 1 – Title ------------------->
<div class="slide active">
    <h1>MAC286 Prof. Khalid Kassou</h1>
    <h1>Double Hashing Hash Tables</h1>
    <div style="text-align:center;font-size:1.2em;color:#7f8c8d;margin:30px 0">
        <p>Two Hash Functions for Superior Collision Resolution</p>
        <p style="margin-top:20px;font-size:.9em">Each key gets its own unique probe sequence</p>
    </div>
    <div style="text-align:center;margin-top:40px">
        <div style="display:inline-block;background:linear-gradient(135deg,#1dd1a1,#10ac84);padding:20px 40px;border-radius:50px;color:#fff;font-size:1.1em">
            Click <strong>Next</strong> to Begin!
        </div>
    </div>
</div>

<!------------------- SLIDE 2 – Definition ------------------->
<div class="slide">
    <h2>What is Double Hashing?</h2>
    <div class="definition-box">
        <h3 style="color:#fff;margin-top:0">Core Idea</h3>
        <p style="font-size:1.2em;line-height:1.6">
            Use <strong>two hash functions</strong>:<br>
            • <code>h1(k)</code> → initial position<br>
            • <code>h2(k)</code> → step size<br>
            Probe: <code>index = (h1(k) + i × h2(k)) % capacity</code>
        </p>
    </div>
    <h3>Why Double?</h3>
    <ul style="font-size:1.1em;line-height:1.8;margin:20px 0;padding-left:30px">
        <li>Eliminates <strong>secondary clustering</strong> (unlike quadratic)</li>
        <li>Each key has a <strong>unique probe pattern</strong></li>
        <li>Better distribution than linear or quadratic</li>
    </ul>
    <div class="scroll-indicator">Scroll for more</div>
</div>

<!------------------- SLIDE 3 – Real-Life Example ------------------->
<div class="slide">
    <h2>Real-Life Example: Library Book Placement</h2>
    <div class="real-life-example">
        <h3 style="color:#2c3e50;margin-top:0">Library Shelving Strategy</h3>
        <p style="font-size:1.1em;line-height:1.7;">
            A librarian uses a book's ISBN to decide:<br>
            1. <strong>Shelf number</strong> (hash1)<br>
            2. <strong>Step size</strong> if shelf is full (hash2)
        </p>
        <br>
        <p style="font-size:1.1em;line-height:1.7;">
            <strong>Example:</strong><br>
            • Book A → hash1 = <code>5</code>, hash2 = <code>3</code><br>
            • Shelf 5 full → try <code>5 + 1×3 = 8</code><br>
            • Shelf 8 full → try <code>5 + 2×3 = 11</code><br>
            • Shelf 11 free → place book!
        </p>
    </div>
    <div style="background:#fff8e1;padding:20px;border-radius:10px;margin-top:20px;">
        <h3>Visual Path:</h3>
        <div style="font-family:'Courier New',monospace;background:#fff;padding:15px;border-radius:8px;margin-top:10px;">
            Shelf 5 [Full] → 8 [Full] → 11 [Free] → Place here!
        </div>
    </div>
</div>

<!------------------- SLIDE 4 – Visual Animation ------------------->
<div class="slide">
    <h2>Visual Animation</h2>
    <div class="hash-table-visual" id="visualDemo"></div>
    <div style="text-align:center;margin-top:20px">
        <button class="demo-button" onclick="startVisualDemo()">Start Animation</button>
        <button class="demo-button" onclick="resetVisualDemo()" style="margin-left:10px;background:linear-gradient(135deg,#e74c3c,#c0392b)">Reset</button>
    </div>
    <div id="visualSteps" style="margin-top:20px;padding:15px;background:#2c3e50;color:#ecf0f1;border-radius:8px;font-family:'Courier New',monospace;font-size:13px">
        Click “Start Animation” to see unique probe sequences.
    </div>
</div>

<!------------------- SLIDE 5 – Interactive Demo ------------------->
<div class="slide">
    <h2>Interactive Demo</h2>
    <div class="interactive-demo">
        <div class="demo-controls">
            <input type="text" id="demoKey" class="demo-input" placeholder="Key (e.g. red)">
            <input type="number" id="demoValue" class="demo-input" placeholder="Value (number)">
            <button class="demo-button" onclick="insertDemo()">Insert</button>
            <button class="demo-button" onclick="searchDemo()">Search</button>
            <button class="demo-button" onclick="clearDemo()" style="background:linear-gradient(135deg,#e74c3c,#c0392b)">Clear</button>
        </div>
        <div class="hash-table-visual" id="interactiveTable"></div>
        <div id="interactiveLog" class="step-log">Ready – try inserting "red", "blue", "green".</div>
    </div>
</div>

<!------------------- SLIDE 6 – Java Code (FIXED & WORKING) ------------------->
<div class="slide">
    <h2>Java Implementation</h2>
    <p style="margin-bottom:20px">Copy and run in <a href="https://www.jdoodle.com/online-java-compiler/" target="_blank" style="color:#10ac84">JDoodle</a> – <strong>100% working</strong>.</p>
    <div class="code-container" style="position:relative">
        <button class="copy-btn" onclick="copyJavaCode()">Copy Code</button>
<pre id="javaCode"><code><span class="comment">// ============================================================================
// DOUBLE HASHING – Classroom Demo (55 lines)
// Real-life: Library – ISBN → shelf + step size
// ============================================================================</span>

<span class="keyword">import</span> java.util.*;

<span class="keyword">public class</span> DoubleHashingSimple {
    <span class="keyword">private</span> String[] keys;
    <span class="keyword">private</span> Integer[] values;
    <span class="keyword">private int</span> capacity;

    <span class="keyword">public</span> <span class="method">DoubleHashingSimple</span>(<span class="keyword">int</span> capacity) {
        <span class="keyword">this</span>.capacity = capacity;
        <span class="keyword">this</span>.keys   = <span class="keyword">new</span> String[capacity];
        <span class="keyword">this</span>.values = <span class="keyword">new</span> Integer[capacity];
    }

    <span class="comment">// ---- Hash 1: initial bucket ------------------------------------------------</span>
    <span class="keyword">private int</span> <span class="method">hash1</span>(String key) {
        <span class="keyword">return</span> Math.abs(key.hashCode()) % capacity;
    }

    <span class="comment">// ---- Hash 2: step size (never 0) -------------------------------------------</span>
    <span class="keyword">private int</span> <span class="method">hash2</span>(String key) {
        <span class="keyword">return</span> 7 - (Math.abs(key.hashCode()) % 7);   <span class="comment">// 1 … 6</span>
    }

    <span class="comment">// ---- Insert ---------------------------------------------------------------</span>
    <span class="keyword">public void</span> <span class="method">put</span>(String key, Integer value) {
        <span class="keyword">int</span> h1 = hash1(key);
        <span class="keyword">int</span> h2 = hash2(key);
        <span class="keyword">int</span> index = h1;
        <span class="keyword">int</span> step  = 0;

        System.out.println(<span class="string">"Inserting "</span> + key + <span class="string">" → hash1="</span> + h1 + <span class="string">", hash2="</span> + h2);

        <span class="keyword">while</span> (keys[index] != <span class="keyword">null</span> && !keys[index].equals(key)) {
            step++;
            index = (h1 + step * h2) % capacity;
            System.out.println(<span class="string">"  Collision! Trying "</span> + h1 + <span class="string">"+"</span> + step + <span class="string">"×"</span> + h2 + <span class="string">" = "</span> + index);
        }

        keys[index]   = key;
        values[index] = value;
        System.out.println(<span class="string">"  Stored at index "</span> + index + <span class="string">"\n"</span>);
    }

    <span class="comment">// ---- Search ---------------------------------------------------------------</span>
    <span class="keyword">public</span> Integer <span class="method">get</span>(String key) {
        <span class="keyword">int</span> h1 = hash1(key);
        <span class="keyword">int</span> h2 = hash2(key);
        <span class="keyword">int</span> index = h1;
        <span class="keyword">int</span> step  = 0;

        <span class="keyword">while</span> (step < capacity) {
            <span class="keyword">if</span> (keys[index] == <span class="keyword">null</span>) <span class="keyword">return null</span>;
            <span class="keyword">if</span> (keys[index].equals(key)) <span class="keyword">return</span> values[index];

            step++;
            index = (h1 + step * h2) % capacity;
        }
        <span class="keyword">return null</span>;
    }

    <span class="comment">// ---- Display ---------------------------------------------------------------</span>
    <span class="keyword">public void</span> <span class="method">display</span>() {
        System.out.println(<span class="string">"=== Double Hashing Hash Table ==="</span>);
        <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i < capacity; i++) {
            <span class="keyword">if</span> (keys[i] == <span class="keyword">null</span>) {
                System.out.println(i + <span class="string">": [EMPTY]"</span>);
            } <span class="keyword">else</span> {
                System.out.println(i + <span class="string">": "</span> + keys[i] + <span class="string">"="</span> + values[i]);
            }
        }
        System.out.println();
    }

    <span class="comment">// ---- Main ------------------------------------------------------------------</span>
    <span class="keyword">public static void</span> <span class="method">main</span>(String[] args) {
        System.out.println(<span class="string">"DOUBLE HASHING DEMO"</span>);
        System.out.println(<span class="string">"Concept: Use 2 hash functions – one for position, one for step size\n"</span>);

        DoubleHashingSimple table = <span class="keyword">new</span> DoubleHashingSimple(11);

        table.put(<span class="string">"red"</span>,   1);
        table.put(<span class="string">"blue"</span>,  2);
        table.put(<span class="string">"green"</span>, 3);

        table.display();

        System.out.println(<span class="string">"Finding 'blue': "</span> + table.get(<span class="string">"blue"</span>));

        System.out.println(<span class="string">"\nAdvantage: Best distribution, each key has unique probe pattern"</span>);
        System.out.println(<span class="string">"Problem: More complex, need good second hash function"</span>);
    }
}</code></pre>
    </div>
    <div class="scroll-indicator">Scroll to copy</div>
</div>

<!------------------- SLIDE 7 – Code Walk-through ------------------->
<div class="slide">
    <h2>Code Walk-through</h2>
    <div style="background:#fff8e1;padding:20px;border-radius:10px;margin:20px 0">
        <h3>Key Lines Explained</h3>
        <ul style="line-height:1.8;font-size:1.1em">
            <li><code>hash1()</code> → initial bucket</li>
            <li><code>hash2()</code> → step size (7 - x ensures ≠ 0)</li>
            <li><code>index = (h1 + step * h2) % capacity</code> → double hashing formula</li>
            <li><code>while (step < capacity)</code> → prevent infinite loop</li>
        </ul>
    </div>
    <h3>Sample Output:</h3>
    <div style="font-family:'Courier New',monospace;background:#2c3e50;color:#ecf0f1;padding:15px;border-radius:8px">
        Inserting red → hash1=5, hash2=3<br>
        Stored at index 5<br><br>
        Inserting blue → hash1=5, hash2=1<br>
        Collision! Trying 5+1×1 = 6<br>
        Stored at index 6
    </div>
</div>

<!------------------- SLIDE 8 – Advantages / Disadvantages ------------------->
<div class="slide">
    <h2>Advantages & Disadvantages</h2>
    <div class="advantages-disadvantages">
        <div class="advantage">
            <h3>Advantages</h3>
            <ul style="margin-top:15px;line-height:1.6">
                <li><strong>Best distribution</strong> – no clustering</li>
                <li>Each key has <strong>unique probe sequence</strong></li>
                <li>High load factors possible</li>
            </ul>
        </div>
        <div class="disadvantage">
            <h3>Disadvantages</h3>
            <ul style="margin-top:15px;line-height:1.6">
                <li>More complex than linear/quadratic</li>
                <li>Requires <strong>good second hash</strong></li>
                <li>Deletion needs <strong>tombstones</strong></li>
            </ul>
        </div>
    </div>
</div>

<!------------------- SLIDE 9 – Time Complexity ------------------->
<div class="slide">
    <h2>Time Complexity</h2>
    <table class="complexity-table">
        <thead><tr><th>Operation</th><th>Best</th><th>Avg</th><th>Worst</th><th>Notes</th></tr></thead>
        <tbody>
            <tr><td><strong>Insert</strong></td><td>O(1)</td><td>O(1)</td><td>O(n)</td><td>if table full</td></tr>
            <tr><td><strong>Search</strong></td><td>O(1)</td><td>O(1)</td><td>O(n)</td><td>long probe</td></tr>
            <tr><td><strong>Delete</strong></td><td>O(1)</td><td>O(1)</td><td>O(n)</td><td>needs tombstone</td></tr>
        </tbody>
    </table>
    <div style="background:#fff8e1;padding:20px;border-radius:10px;margin-top:20px">
        <p><strong>Load Factor Rule:</strong> Keep <code>α ≤ 0.7</code> for optimal performance</p>
    </div>
</div>

<!------------------- SLIDE 10 – Summary ------------------->
<div class="slide">
    <h2>Summary</h2>
    <div style="background:linear-gradient(135deg,#1dd1a1,#10ac84);color:#fff;padding:25px;border-radius:10px">
        <h3 style="color:#fff;margin-top:0">Key Takeaways</h3>
        <ul style="font-size:1.1em;line-height:1.8;margin-top:15px">
            <li>Double hashing = <code>h1(k) + i × h2(k)</code></li>
            <li>Eliminates all clustering</li>
            <li>Real-world: library shelving with step size</li>
            <li>Best open addressing technique</li>
        </ul>
    </div>
    <div style="text-align:center;margin-top:30px">
        <div style="display:inline-block;background:linear-gradient(135deg,#55efc4,#00b894);padding:20px 40px;border-radius:50px;color:#fff;font-size:1.2em;font-weight:bold">
            You’ve Mastered Double Hashing!
        </div>
    </div>
</div>

</div>

<!------------------- NAVIGATION ------------------->
<div class="navigation">
    <button class="nav-button" id="prevBtn" onclick="previousSlide()">Prev</button>
    <div id="slideCounter" style="background:rgba(44,62,80,.9);color:#fff;padding:15px 20px;border-radius:50px;display:flex;align-items:center;font-weight:bold;box-shadow:0 4px 15px rgba(44,62,80,.4)">
        1 / 10
    </div>
    <button class="nav-button" id="nextBtn" onclick="nextSlide()">Next</button>
</div>

<script>
/* ---------- GLOBAL STATE ---------- */
const slides = document.querySelectorAll('.slide');
const totalSlides = slides.length;
let currentSlide = 0;

const demoTable = {
    capacity: 11,
    keys: Array(11).fill(null),
    values: Array(11).fill(null)
};

/* ---------- COPY CODE ---------- */
function copyJavaCode() {
    const code = document.getElementById('javaCode').innerText;
    navigator.clipboard.writeText(code).then(()=>{
        const btn = document.querySelector('.copy-btn');
        const orig = btn.textContent;
        btn.textContent='Copied!';
        btn.style.background='#27ae60';
        setTimeout(()=>{btn.textContent=orig; btn.style.background='';},2000);
    });
}

/* ---------- UI HELPERS ---------- */
function updateProgress() {
    const pct = ((currentSlide+1)/totalSlides)*100;
    document.getElementById('progressBar').style.width = pct+'%';
}
function showSlide(n){
    slides[currentSlide].classList.remove('active');
    currentSlide = (n+totalSlides)%totalSlides;
    slides[currentSlide].classList.add('active');
    updateProgress();
    document.getElementById('slideCounter').textContent = `${currentSlide+1} / ${totalSlides}`;
    document.getElementById('prevBtn').disabled = currentSlide===0;
    document.getElementById('nextBtn').disabled = currentSlide===totalSlides-1;
}
function nextSlide(){ if(currentSlide<totalSlides-1) showSlide(currentSlide+1); }
function previousSlide(){ if(currentSlide>0) showSlide(currentSlide-1); }
document.addEventListener('keydown',e=>{
    if(e.key==='ArrowRight') nextSlide();
    if(e.key==='ArrowLeft') previousSlide();
});

/* ---------- HASH (demo) ---------- */
function demoHash1(key){
    let h=0;
    for(let i=0;i<key.length;i++) h=((h<<5)-h)+key.charCodeAt(i);
    return Math.abs(h)%demoTable.capacity;
}
function demoHash2(key){
    return 7 - (Math.abs(key.hashCode())%7);
}

/* ---------- VISUAL DEMO ---------- */
function initTable(id){
    const cont = document.getElementById(id);
    cont.innerHTML='';
    for(let i=0;i<demoTable.capacity;i++){
        const slot = document.createElement('div');
        slot.className='hash-slot';
        slot.innerHTML=`<div class="index">${i}</div><div>Empty</div>`;
        cont.appendChild(slot);
    }
}
function renderTable(id){
    const slots = document.querySelectorAll(`#${id} .hash-slot`);
    slots.forEach((s,i)=>{
        s.className='hash-slot';
        if(demoTable.keys[i]!==null){
            s.classList.add('occupied');
            s.innerHTML=`<div class="index">${i}</div><div>${demoTable.keys[i]}=${demoTable.values[i]}</div>`;
        }else{
            s.innerHTML=`<div class="index">${i}</div><div>Empty</div>`;
        }
    });
}
function startVisualDemo(){
    resetDemo();
    const steps = document.getElementById('visualSteps');
    const data = [{k:'red',v:1},{k:'blue',v:2},{k:'green',v:3}];
    let i=0;
    function step(){
        if(i>=data.length){ steps.innerHTML='Animation complete!'; return; }
        const {k,v}=data[i];
        const h1 = demoHash1(k);
        const h2 = demoHash2(k);
        let idx = h1;
        let stepCount = 0;
        steps.innerHTML=`Insert "${k}" → h1=${h1}, h2=${h2}`;
        while(demoTable.keys[idx]!==null && stepCount<demoTable.capacity){
            stepCount++;
            idx = (h1 + stepCount*h2)%demoTable.capacity;
        }
        let cur = h1;
        let s = 0;
        const highlight = ()=>{
            if(s<stepCount){
                document.querySelectorAll('#visualDemo .hash-slot')[cur].classList.add('collision');
                setTimeout(()=>{
                    document.querySelectorAll('#visualDemo .hash-slot')[cur].classList.remove('collision');
                    s++;
                    cur = (h1 + s*h2)%demoTable.capacity;
                    if(s<stepCount) highlight();
                    else finalize();
                },800);
            }else finalize();
        };
        const finalize = ()=>{
            demoTable.keys[idx]=k;
            demoTable.values[idx]=v;
            renderTable('visualDemo');
            steps.innerHTML+=`<br>Probed ${stepCount} steps → Stored at ${idx}`;
            i++;
            setTimeout(step,1500);
        };
        if(stepCount===0) finalize();
        else highlight();
    }
    step();
}
function resetVisualDemo(){
    demoTable.keys.fill(null);
    demoTable.values.fill(null);
    initTable('visualDemo');
    renderTable('visualDemo');
    document.getElementById('visualSteps').innerHTML='Click “Start Animation” to see unique probe sequences.';
}

/* ---------- INTERACTIVE DEMO ---------- */
initTable('interactiveTable');
function insertDemo(){
    const key = document.getElementById('demoKey').value.trim();
    const val = parseInt(document.getElementById('demoValue').value);
    const log = document.getElementById('interactiveLog');
    if(!key || isNaN(val)){ log.textContent='Enter key & number'; return; }
    const h1 = demoHash1(key);
    const h2 = demoHash2(key);
    let idx = h1;
    let step = 0;
    const steps = [`Insert "${key}" → h1=${h1}, h2=${h2}`];
    while(demoTable.keys[idx]!==null && demoTable.keys[idx]!==key && step<demoTable.capacity){
        step++;
        idx = (h1 + step*h2)%demoTable.capacity;
        steps.push(`Collision → try ${step}×${h2} = ${idx}`);
    }
    demoTable.keys[idx]=key;
    demoTable.values[idx]=val;
    steps.push(`Stored @${idx}`);
    renderTable('interactiveTable');
    log.innerHTML=steps.join('<br>');
    document.getElementById('demoKey').value='';
    document.getElementById('demoValue').value='';
}
function searchDemo(){
    const key = document.getElementById('demoKey').value.trim();
    const log = document.getElementById('interactiveLog');
    if(!key){ log.textContent='Enter a key'; return; }
    const h1 = demoHash1(key);
    const h2 = demoHash2(key);
    let idx = h1;
    let step = 0;
    const steps = [`Search "${key}" → h1=${h1}, h2=${h2}`];
    while(step<demoTable.capacity){
        if(demoTable.keys[idx]===null){
            steps.push(`Empty → not found`);
            break;
        }
        if(demoTable.keys[idx]===key){
            steps.push(`Found @${idx} = ${demoTable.values[idx]}`);
            log.innerHTML=steps.join('<br>');
            highlightSlot(idx,'interactiveTable');
            return;
        }
        step++;
        idx = (h1 + step*h2)%demoTable.capacity;
        steps.push(`Check ${idx}...`);
    }
    log.innerHTML=steps.join('<br>');
}
function clearDemo(){
    demoTable.keys.fill(null);
    demoTable.values.fill(null);
    renderTable('interactiveTable');
    document.getElementById('interactiveLog').textContent='Table cleared!';
}
function highlightSlot(idx, container){
    const slot = document.querySelectorAll(`#${container} .hash-slot`)[idx];
    slot.classList.add('highlight-animation');
    setTimeout(()=>slot.classList.remove('highlight-animation'),2000);
}

/* ---------- INITIALISE ---------- */
initTable('visualDemo');
updateProgress();
showSlide(0);
</script>
</body>
</html>